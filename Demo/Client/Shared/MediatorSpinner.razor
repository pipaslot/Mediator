@using Demo.Client.Shared.Components
@using Pipaslot.Mediator.Middlewares
<Spinner Show="_show" />

@implements IDisposable
@inject ActionEventsMiddleware ActionEvents;
@code {
    private bool _show;

    protected override void OnInitialized()
    {
        ActionEvents.ActionStarted += OnStarted;
        ActionEvents.ActionCompleted += OnFinished;
    }
    public void Dispose()
    {
        ActionEvents.ActionStarted -= OnStarted;
        ActionEvents.ActionCompleted -= OnFinished;
    }

    private void OnStarted(object? sender, ActionStartedEventArgs args)
    {
        if (!_show)
        {
            _show = true;
            StateHasChanged();

        }
    }
    private void OnFinished(object? sender, ActionCompletedEventArgs args)
    {
        if (_show && args.RunningActions.Count == 0)
        {
            _show = false;
            StateHasChanged();
        }
    }
}
